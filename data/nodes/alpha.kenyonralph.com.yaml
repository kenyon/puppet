---
# NAT64.net
systemd::dns:
  - 2a01:4f8:c2c:123f::1
  - 2a01:4f9:c010:3f02::1
  - 2a00:1098:2b::1

systemd_networks:
  main:
    content: |
      [Match]
      Name=en*
      [IPv6AcceptRA]
      UseDNS=false

rsyslog::config::actions:
  daemon:
    priority: 54
    type: omfile
    facility: daemon.*
    config:
      file: /var/log/daemon.log
  mail:
    type: omfile
    facility: mail.*
    config:
      file: /var/log/mail.log
  syslog:
    type: omfile
    facility: '*.*'
    config:
      file: /var/log/syslog

rsyslog::config::expression_filters:
  # filter named junk messages
  named1:
    conditionals:
      if:
        expression: $msg contains 'received control channel command \'stats\''
        tasks:
          - stop: true
  named2:
    conditionals:
      if:
        expression: $msg contains 'dumpstats complete'
        tasks:
          - stop: true
  named sl spam:
    conditionals:
      if:
        expression: $msg contains 'query failed (REFUSED) for sl/IN/ANY'
        tasks:
          - stop: true
  # filter edgerouter junk
  edgerouter:
    conditionals:
      if:
        expression: $msg contains '/usr/sbin/ubnt-check-unms.sh'
        tasks:
          - stop: true

rsyslog::config::inputs:
  imrelp:
    type: imrelp
    config:
      port: 20514

rsyslog::config::modules:
  imklog: {}
  immark: {}
  imrelp: {}
  imuxsock: {}
  omfile:
    type: builtin
    config:
      FileCreateMode: '0640'
      FileOwner: root
      FileGroup: adm
