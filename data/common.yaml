---
# Common data.

classes:
  - systemd::systemctl::daemon_reload
  - timezone
  - sudo
  - git
  - ssh
  - mysite::ntp
  - rsyslog::client
  - accounts

lookup_options:
  accounts::user_list:
    merge: deep
  accounts::group_list:
    merge: deep
  apt::sources:
    merge: hash
  rhsm::enabled_repo_ids:
    merge: unique
  rsyslog::client::actions:
    merge: hash
  rsyslog::client::global_config:
    merge: hash
  rsyslog::client::inputs:
    merge: hash
  rsyslog::client::modules:
    merge: hash

timezone::timezone: America/Los_Angeles

# NTP servers to use for hosts that are in the NTP Pool.
ntp_servers:
  - clock.fmt.he.net
  - ntp.caida.org
  - ntp.vt.edu

# Packages I want installed.
packages:
  - aspell
  - colordiff
  - curl
  - emacs-nox
  - etckeeper
  - htop
  - info
  - keychain
  - lsof
  - mlocate
  - multitail
  - mutt
  - ndisc6
  - nmap # nmap includes ncat, its version of netcat (nc)
  - psmisc
  - pwgen
  - rsync
  - rsyslog-relp
  - subnetcalc
  - time
  - tmux
  - tree
  - unzip
  - w3m
  - wget
  - whois
  - zsh

# Packages I want to be absent.
# Can't really remove multiple packages though, even if I have listed
# all of their dependencies, because it tries to remove each package
# individually:
# https://tickets.puppetlabs.com/browse/PUP-146
# https://tickets.puppetlabs.com/browse/PUP-1061
packages_absent:
  - nano

# Ruby gems.
gems: []

services:
  ctrl-alt-del.target:
    ensure: stopped
    enable: mask

accounts::user_list:
  kenyon:
    ignore_password_if_empty: true
    password: ''
    comment: Kenyon Ralph
    shell: /bin/zsh
    groups:
      - sudo
      - adm
    managevim: false
    sshkeys:
      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKcX1L+30WOCRpdhUAUBB7MedN2hteApi8E7RUVOPxsO kenyon@einstein

sudo::configs:
  insults:
    content: Defaults insults
  kenyon:
    content: 'kenyon ALL = (ALL:ALL) NOPASSWD: ALL'
  lessenv:
    content: Defaults env_keep += "LESS_TERMCAP_us LESS_TERMCAP_ue LESS_TERMCAP_so LESS_TERMCAP_se LESS_TERMCAP_me LESS_TERMCAP_md LESS_TERMCAP_mb"
  lessenv2:
    content: Defaults env_keep += "PAGER LESS MANWIDTH LESSOPEN BLOCKSIZE"

git::configs:
  user.name:
    value: Kenyon Ralph
    user: kenyon
  user.email:
    value: kenyon@kenyonralph.com
    user: kenyon
  user.signingkey:
    value: '0x98FF3EF9C9B912D5'
    user: kenyon
  color.ui:
    value: always
    user: kenyon
  commit.verbose:
    value: 'true'
    user: kenyon
  commit.gpgsign:
    value: 'true'
    user: kenyon
  core.pager:
    value: less --quit-if-one-screen --LONG-PROMPT --ignore-case --RAW-CONTROL-CHARS --HILITE-UNREAD --no-init
    user: kenyon
  log.decorate:
    value: full
    user: kenyon

augeases:
  puppet.conf:
    context: /files/etc/puppetlabs/puppet/puppet.conf
    changes:
      - set main/show_diff true
      - set main/server puppet.kenyonralph.com
  system.conf:
    incl: /etc/systemd/system.conf
    lens: Puppet.lns
    changes:
      - set Manager/CtrlAltDelBurstAction none
    notify: Exec[systemctl-daemon-reload]

cronjobs: {}

execs: {}

file_lines: {}

files:
  /etc/zlogout:
    ensure: absent
  /etc/puppetlabs/facter:
    ensure: directory
    mode: '0755'
    owner: root
    group: root
  /etc/puppetlabs/facter/facter.conf:
    ensure: file
    mode: '0644'
    owner: root
    group: root
    content: |
      facts : {
          blocklist : [ "EC2" ],
      }

sysctls:
  net.core.default_qdisc:
    ensure: present
    value: fq_codel
    target: /etc/sysctl.d/97-net-sysctl.conf
  net.ipv4.tcp_ecn:
    ensure: present
    value: 1
    target: /etc/sysctl.d/97-net-sysctl.conf
  net.ipv4.tcp_mtu_probing:
    ensure: present
    value: 2
    target: /etc/sysctl.d/97-net-sysctl.conf

ssh::client_options:
  Host *:
    HashKnownHosts: no

postfix_configs: {}
postfix_hashes: {}

rsyslog::client::global_config:
  # This can be placed in the global() configuration object in
  # rsyslog 8.26.0+.
  umask:
    value: '0022'
    type: legacy

rsyslog::client::modules:
  imuxsock: {}
  imklog: {}
  immark: {}
  omrelp: {}
  omfile:
    type: builtin
    config:
      FileCreateMode: '0640'
      FileOwner: root
      FileGroup: adm

rsyslog::client::actions:
  forward_all:
    type: omrelp
    facility: '*.*'
    config:
      target: syslog.kenyonralph.com
      port: 20514
  syslog:
    type: omfile
    facility: '*.*'
    config:
      file: /var/log/syslog
  mail:
    type: omfile
    facility: mail.*
    config:
      file: /var/log/mail.log

# Local Variables:
# coding: utf-8
# End:
...
